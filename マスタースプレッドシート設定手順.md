# マスタースプレッドシート 設定手順

全施設を統合管理するマスタースプレッドシートの作成手順です。

## 1. 新規スプレッドシート作成

1. Googleスプレッドシートにアクセス
2. 「空白」から新規スプレッドシートを作成
3. スプレッドシート名を「**全施設管理マスター**」に変更

---

## 2. シート構成の作成

デフォルトの「シート1」を含めて、以下の3つのシートを作成します:

### シート名の設定

1. 「シート1」を右クリック → 名前を変更 → 「**施設マスタ**」
2. 下部の「+」ボタンで新規シート作成 → 「**全施設管理者**」
3. もう一度「+」ボタンで新規シート作成 → 「**システム設定**」

最終的に3つのシートができます:
- 施設マスタ
- 全施設管理者
- システム設定

---

## 3. 「施設マスタ」シートの設定

### ヘッダー行（1行目）の作成

「施設マスタ」シートを開き、1行目に以下の列名を入力してください:

| A列 | B列 | C列 | D列 | E列 | F列 |
|-----|-----|-----|-----|-----|-----|
| 施設ID | 施設名 | 施設管理者名 | 施設メールアドレス | 施設パスワード | スプレッドシートID |

| G列 | H列 | I列 | J列 | K列 | L列 |
|-----|-----|-----|-----|-----|-----|
| 年度 | 作成日時 | 更新日時 | ステータス | 備考 | ドライブフォルダID |

| M列 | N列 | O列 | P列 | Q列 | R列 |
|-----|-----|-----|-----|-----|-----|
| 施設住所 | 施設電話番号 | 契約開始日 | 契約終了日 | 利用者定員 | テンプレートID |

### ヘッダー行の書式設定（任意）

1. 1行目を選択
2. 「太字」にする
3. 背景色を設定（例: 薄い青）
4. 「表示」→「固定」→「1行」を選択（スクロール時にヘッダーを固定）

### データの入力は不要

このシートにはアプリから施設登録時に自動的にデータが追加されます。
手動でデータを入力する必要はありません。

---

## 4. 「全施設管理者」シートの設定

### ヘッダー行（1行目）の作成

「全施設管理者」シートを開き、1行目に以下の列名を入力してください:

| A列 | B列 | C列 | D列 | E列 | F列 | G列 | H列 | I列 |
|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| 管理者ID | 管理者名 | メールアドレス | パスワード | 権限レベル | 作成日時 | 更新日時 | ステータス | 備考 |

### ヘッダー行の書式設定（任意）

1. 1行目を選択
2. 「太字」にする
3. 背景色を設定（例: 薄い緑）
4. 「表示」→「固定」→「1行」を選択

### 初期データの入力（重要）

2行目に、あなた（全施設管理者）のアカウント情報を入力してください:

| A列 | B列 | C列 | D列 | E列 | F列 | G列 | H列 | I列 |
|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| ADMIN001 | （あなたの名前） | （ログイン用メールアドレス） | （ログイン用パスワード） | 0 | （現在の日時） | （現在の日時） | 有効 | 本社管理者 |

**入力例**:
```
A2: ADMIN001
B2: 鈴木一郎
C2: admin@yourcompany.com
D2: YourSecurePassword123
E2: 0
F2: 2024/12/06 15:00:00
G2: 2024/12/06 15:00:00
H2: 有効
I2: 本社管理者
```

**重要**:
- **E列（権限レベル）は必ず「0」**（数値）を入力
- **H列（ステータス）は必ず「有効」**を入力
- メールアドレスとパスワードは実際にログインで使用します

---

## 5. 「システム設定」シートの設定

### ヘッダー行（1行目）の作成

「システム設定」シートを開き、1行目に以下の列名を入力してください:

| A列 | B列 | C列 | D列 |
|-----|-----|-----|-----|
| 設定キー | 設定値 | 説明 | 更新日時 |

### ヘッダー行の書式設定（任意）

1. 1行目を選択
2. 「太字」にする
3. 背景色を設定（例: 薄い黄）
4. 「表示」→「固定」→「1行」を選択

### 初期データの入力（任意）

2行目に、アプリバージョン情報を入力してください（任意）:

| A列 | B列 | C列 | D列 |
|-----|-----|-----|-----|
|  | 2.0.0 | アプリバージョン | 2024/12/06 15:00:00 |

---

## 6. スプレッドシートIDの確認

マスタースプレッドシートのIDを確認してメモしておきます:

1. スプレッドシートのURLを確認
   ```
   https://docs.google.com/spreadsheets/d/【ここがスプレッドシートID】/edit
   ```

2. 「【ここがスプレッドシートID】」の部分（長い英数字）をコピー

**例**:
```
URL: https://docs.google.com/spreadsheets/d/1abc2def3ghi4jkl5mno6pqr7stu8vwx9yz0/edit
スプレッドシートID: 1abc2def3ghi4jkl5mno6pqr7stu8vwx9yz0
```

このIDは後でGASコードの設定で使用します。

---

## 7. 共有設定（セキュリティ）

マスタースプレッドシートは機密情報を含むため、適切な共有設定を行います:

1. 右上の「共有」ボタンをクリック
2. 「制限付き」のままにする（一般公開しない）
3. 必要に応じて、信頼できる管理者のみにアクセス権を付与

**重要**: このスプレッドシートには施設のパスワード等が含まれるため、公開しないでください。

---

## 完成イメージ

### 施設マスタシート
```
| 施設ID | 施設名 | 施設管理者名 | 施設メールアドレス | ... |
|--------|--------|--------------|-------------------|-----|
| （空）  | （空）  | （空）        | （空）             | ... |
```
※データはアプリから自動追加されます

### 全施設管理者シート
```
| 管理者ID | 管理者名 | メールアドレス | パスワード | 権限レベル | ... |
|----------|----------|---------------|-----------|-----------|-----|
| ADMIN001 | 鈴木一郎  | admin@... | ******* | 0 | ... |
```

### システム設定シート
```
| 設定キー | 設定値 | 説明 | 更新日時 |
|----------|--------|------|----------|
| app_version | 2.0.0 | アプリバージョン | 2024/12/06 15:00:00 |
```

---

## 次のステップ

マスタースプレッドシートの作成が完了したら、以下の情報を確認してください:

✅ スプレッドシートID（URL内の長い英数字）
✅ 全施設管理者のメールアドレス
✅ 全施設管理者のパスワード

これらの情報を使って、次はGASコードの設定とアプリへの組み込みを行います。
