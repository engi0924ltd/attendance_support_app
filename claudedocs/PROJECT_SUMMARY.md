# 出勤支援アプリ プロジェクトサマリー

## 絶対ルール

### 1. パフォーマンス最優先
**アプリとGASの読み込み・書き出し速度を何より優先する**
- 一括取得・一括書き込みを使用
- 不要なAPI呼び出しを避ける
- キャッシュを活用
- ループ内でのgetRange/setValueを避ける

### 2. GASファイル編集ルール
- **編集対象**: `assets/gas/gas_code_v4.js`
- **編集禁止**: ルート直下の `gas_code_v4.js`, `master_gas_code_*.js` は**バックアップ専用**

---

## シート構成

### 1. 全権管理者シート - 施設マスタ

| 列 | フィールド名 | 説明 |
|---|---|---|
| A | FACILITY_ID | 施設ID（厚労省番号） |
| B | FACILITY_NAME | 施設名 |
| C | ADMIN_NAME | 施設管理者名 |
| D | ADMIN_EMAIL | 施設メールアドレス |
| E | ADMIN_PASSWORD | 管理者パスワード |
| F | SPREADSHEET_ID | スプレッドシートID |
| G | FISCAL_YEAR | 年度 |
| H | CREATED_AT | 作成日時 |
| I | UPDATED_AT | 更新日時 |
| J | STATUS | ステータス |
| K | CHATWORK_API_KEY | ChatWork APIキー |
| L | DRIVE_FOLDER_ID | ドライブフォルダID |
| M | ADDRESS | 施設住所 |
| N | PHONE | 施設電話番号 |
| O | CONTRACT_START | 契約開始日 |
| P | CONTRACT_END | 契約終了日 |
| Q | CAPACITY | 利用者定員 |
| R | TEMPLATE_ID | テンプレートID |
| S | GAS_URL | GAS URL |
| T | TIME_ROUNDING | 時間設定 |
| U | FACILITY_CODE | 施設コード |
| V | FACILITY_PASSWORD | 施設パスワード |

---

### 2. マスタ設定シート

#### 利用者データ（8行目〜、C〜L列）
| 列 | フィールド名 |
|---|---|
| C | 利用者名 |
| D | フリガナ |
| E | 契約状態 |
| F〜L | 曜日別出欠予定（月〜日） |

#### 職員データ（8〜40行目、V〜AD列）
| 列 | フィールド名 |
|---|---|
| V | 職員名 |
| W | 権限 |
| X | メールアドレス |
| Y | パスワード |
| Z | 職種 |
| AA | 保有福祉資格 |
| AB | 職員配置 |
| AC | 雇用形態 |
| AD | 退職日 |

---

### 3. 支援記録_2025シート

| 列 | フィールド名 |
|---|---|
| A | 日時 |
| B | 利用者名 |
| C | 出欠（予定） |
| D | 出欠 |
| E | 担当業務AM |
| F | 担当業務PM |
| G | 業務連絡 |
| H | 本日の体調 |
| I | 睡眠状況 |
| J | 出勤時コメント |
| K | 疲労感 |
| L | 心理的負荷 |
| M | 退勤時コメント |
| N-O | （予備） |
| P | 勤務開始時刻 |
| Q | 勤務終了時刻 |
| R | 昼休憩 |
| S | 15分休憩 |
| T | 他休憩時間 |
| U | 実労時間 |
| V | 食事提供 |
| W | 欠席対応 |
| X | 訪問支援 |
| Y | 送迎 |
| Z | 本人の状況 |
| AA | 勤務地 |
| AB | 記録者 |
| AC | （予備） |
| AD | 在宅支援評価対象 |
| AE | 施設外評価対象 |
| AF | 作業目標 |
| AG | 勤務評価 |
| AH | 就労評価 |
| AI | 就労意欲 |
| AJ | 通信連絡対応 |
| AK | 評価 |
| AL | 利用者の感想 |

---

### 4. 名簿_2025シート（主要列）

| 列 | フィールド名 |
|---|---|
| A | 人数 |
| B | 氏名 |
| C | 氏名カナ |
| D | 年齢 |
| E | ステータス |
| F | 携帯電話番号 |
| G | ChatWorkルームID |
| H | mail |
| I〜BH | その他詳細情報 |

---

## プルダウン設定（マスタ設定シート）

### 出勤・退勤関連（N〜O列）
| 行範囲 | 列 | 内容 |
|---|---|---|
| 8〜17 | N | 本日の体調 |
| 8〜17 | O | 睡眠状況 |
| 31〜40 | N | 疲労感 |
| 31〜40 | O | 心理的負荷 |

### 職員関連（T〜X列）
| 行範囲 | 列 | 内容 |
|---|---|---|
| 44〜55 | T | 資格選択肢 |
| 44〜55 | U | 職員配置選択肢 |
| 44〜55 | V | 職種 |
| 44〜55 | W | 勤務地 |
| 44〜55 | X | 雇用形態 |

### 評価関連（AE列）
| 行範囲 | 列 | 内容 |
|---|---|---|
| 30〜40 | AE | 勤怠評価 |

### 利用者・名簿関連（K〜S列）
| 行範囲 | 列 | 内容 |
|---|---|---|
| 44〜55 | K | 曜日別出欠予定 |
| 44〜50 | L | ステータス |
| 44〜50 | M | 生活保護 |
| 44〜50 | N | 障がい者手帳年金 |
| 44〜50 | O | 障害等級 |
| 44〜50 | P | 障害種別 |
| 44〜50 | Q | 障害支援区分 |
| 44〜50 | R | 契約形態 |
| 44〜50 | S | 定着支援有無 |

---

## 実装状況

詳細は `claudedocs/IMPLEMENTATION_STATUS.md` を参照

### 完了済み機能
- [x] 利用者機能（出勤/退勤登録）
- [x] 支援者機能（勤怠管理、支援記録、分析、Chatwork連絡）
- [x] 施設管理者機能（職員管理、利用者管理）
- [x] 全権管理者機能（施設管理）
- [x] Chatwork一斉送信（GASエンドポイント含む）
- [x] GASパフォーマンス最適化

---

## ファイルパス

### 編集対象GAS
```
assets/gas/gas_code_v4.js
```

### 編集禁止（バックアップ）
```
gas_code_v4.js
master_gas_code_final.js
```
